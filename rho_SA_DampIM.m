function [rho50,sigma_z] = rho_SA_DampIM(x_T,x_Damp1,x_Damp2,PairIM)

% Created by Mao-Xin Wang (dr.maoxin.wang@gmail.com or maoxinwang@ust.hk)
% August 2024
%
% Predict correlations of SA with damping-dependent ASI, SI, or DSI
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT
%   x_T      = period of SA (in units of s)
%   x_Damp1  = damping ratio of SA (not in percentage!)
%   x_Damp2  = damping ratio of ASI, SI, or DSI (not in percentage!)
%             (the above inputs must be in the same dimension)
%   PairIM   = pair of the intensity measures, which can be
%             'SA-ASI', 'SA-SI', or 'SA-DSI'
%
% OUTPUT
%   rho50    = median correlation coefficient
%   sigma_z  = standard deviation of the z variable
%
% EXAMPLE
%   % predict correlation between SA(0.15 s, 10%) and SI(5%)
%   [rho50,sigma_z] = rho_SA_DampIM(0.15,0.1,0.05,'SA-SI')
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Model Coefficients
switch PairIM
    case 'SA-ASI'
        w1 = [-26.9179 	33.6941 	-19.2540 	-21.2687 	-1.3778 	-20.3086 	26.8790 	27.2837 	36.0393 	-33.6836 	9.8892 	4.0530 	-16.4520 	24.4499 	-5.8985 	-122.0891 	-1.5219 	-30.4768 	-7.6598 	-56.6377 	24.1236 	16.0477 	19.3872 	39.1886 	35.1923 	-25.2842 	-4.1346 	-6.6860 	-19.8205 	-33.9017 	39.2602 	24.0869 	32.1506 	35.6920 	34.0632 	5.0682 	-54.5339 	-54.7782 	27.3728 	35.7309 	-53.2750 	47.5153 	58.7823 	27.8996 	-63.1571 	2.2506 	-54.1190 	-6.0263 	-15.9116 	-18.9160 	2.2375 	9.3572 	-55.0100 	62.5321 	66.5671 	-29.3347 	-92.2513 	-10.8852 	-9.5889 	-5.4390 	-17.2453 	10.9924 	-17.6144 	-12.8644 	-71.2864 	-19.6298 	11.4117 	-43.4369 	-2.4240 	4.0045];
        w2 = [-0.8237 	8.3145 	0.5253 	-0.6370 	1.0885 	41.5174 	-49.0428 	-49.4432 	20.4195 	-8.6284 	1.2674 	-3.8578 	-0.4888 	-1.2219 	0.7887 	-5.9745 	-1.5039 	-4.2147 	-0.7757 	6.2684 	-11.6234 	-0.8830 	-1.4751 	-3.1433 	0.5987 	4.7587 	3.9594 	-2.4188 	-2.3243 	-9.0145 	5.0153 	-11.5786 	-1.8866 	4.7350 	-3.9436 	9.2840 	5.6873 	4.9151 	-6.2267 	-4.2297 	-0.8377 	-0.3827 	-0.4136 	3.9817 	-5.5328 	4.8198 	5.1694 	-2.1659 	0.3555 	1.7745 	4.8237 	5.4364 	-0.9767 	5.5658 	-0.6313 	7.1548 	0.9666 	2.2723 	-5.7307 	1.1853 	2.9338 	1.5870 	2.8228 	-1.2395 	1.3219 	41.0747 	-2.3865 	2.5047 	-0.8324 	-0.7242];
        w3 = [-0.5166 	-5.8458 	-0.2380 	-0.5090 	0.5427 	-4.0985 	8.4519 	8.4832 	45.0472 	5.5923 	-4.8770 	4.9320 	-0.5312 	-0.6143 	-0.8817 	4.7927 	4.0047 	0.5640 	5.2529 	-4.7036 	12.5997 	0.1698 	1.0185 	2.2898 	0.7576 	-2.6481 	-4.8609 	3.5499 	0.2554 	5.3763 	-1.8562 	12.6574 	2.5793 	-1.3274 	0.0370 	-11.5777 	-4.8934 	-5.9304 	2.8380 	-0.1110 	-2.1588 	-0.1145 	-0.1776 	-0.1067 	2.9642 	-2.0567 	-5.4319 	3.2712 	-3.8935 	-0.9874 	-2.1712 	-4.2782 	-2.1204 	-2.7335 	-0.2222 	-2.9820 	0.3008 	-27.8786 	4.3061 	0.0901 	4.2035 	-5.3625 	4.0659 	2.9933 	3.8761 	-4.1418 	29.3960 	-3.1537 	-0.6345 	5.2901];
        v = [1.6570 	1.1199 	0.4060 	-3.2295 	0.8329 	-0.1186 	-0.1485 	0.1438 	-0.0021 	2.1421 	-0.0832 	0.1853 	1.7571 	-0.0516 	-1.5192 	-0.0039 	0.0424 	0.9338 	0.0394 	-0.7365 	-0.1238 	0.7376 	1.2572 	-0.0396 	0.0920 	0.2005 	0.1972 	-0.1405 	0.2205 	-1.0323 	-0.0280 	0.1190 	0.0525 	0.3557 	0.9299 	-0.0022 	1.6134 	0.4580 	0.1756 	-0.7558 	-0.6384 	1.3444 	-0.3894 	0.5852 	-0.3072 	0.9567 	-1.3305 	0.1604 	-0.1320 	1.1310 	-0.9152 	-0.0588 	0.6547 	-0.2949 	-1.1341 	0.0713 	-0.3652 	0.2077 	-0.0517 	1.2557 	0.4721 	0.0810 	-0.5294 	-0.2008 	-0.0555 	0.1334 	0.1864 	-0.0769 	1.2161 	0.1888  ;
            -10.6693 	-20.9005 	-11.6221 	25.1570 	-1.1404 	3.2142 	3.7520 	-3.7324 	-0.0566 	-41.1628 	-8.1860 	-7.4393 	-17.6420 	-1.7489 	3.6285 	0.3706 	-1.2127 	-49.5022 	-0.5075 	36.8977 	4.1892 	-13.4894 	41.1618 	-6.6857 	1.2356 	27.3490 	-7.4179 	-12.6541 	-0.1490 	20.0197 	26.5621 	-4.1757 	2.4990 	-54.1493 	-23.5138 	0.0769 	-93.7298 	-36.9679 	44.3412 	19.4207 	-26.9602 	-97.6367 	31.8679 	-20.8075 	-9.8575 	-10.3585 	91.2925 	17.6940 	0.5160 	25.3009 	10.5255 	17.7698 	24.5916 	-10.1872 	83.4660 	22.1964 	24.6880 	-9.0363 	15.4234 	-4.0681 	-6.1863 	6.4249 	6.6145 	-1.6233 	-0.5788 	-3.2597 	-8.5245 	1.3047 	-0.1642 	-2.8754];
        b = [25.1370 	-17.6276 	15.4686 	20.0265 	-1.1280 	18.0414 	-16.8477 	-17.1063 	-11.4764 	17.8531 	0.3342 	-3.7471 	15.9114 	-14.9999 	8.0254 	59.8461 	-2.4019 	15.2615 	0.6778 	26.8487 	-13.4722 	-12.7162 	-6.4666 	-13.5875 	-24.4963 	11.1038 	3.7333 	3.5061 	12.6321 	18.2080 	-19.3035 	-13.4918 	-17.1137 	-17.7077 	-14.3231 	0.4256 	26.0533 	26.7421 	-11.5423 	-14.9670 	22.0172 	-17.5770 	-20.3570 	-13.9940 	27.7747 	-3.3489 	26.1787 	2.8743 	4.6863 	5.7207 	-3.3203 	-4.3153 	22.6735 	-27.6617 	-25.4856 	12.1526 	35.7131 	4.2550 	4.5230 	3.5143 	-3.4697 	0.2657 	-3.3088 	3.3029 	1.6949 	17.5212 	-4.5356 	13.0547 	1.3807 	0.2139];
        b0 = [-3.6577;  -2.1263];
    case 'SA-SI'
        w1 = [20.6077 	25.2058 	-11.9443 	54.2013 	-32.9782 	-12.3238 	2.1551 	-6.4874 	12.2176 	-33.0227 	-6.0217 	125.3727 	13.8417 	-106.1385 	-47.6283 	-53.8813 	16.9432 	11.0010 	-17.8937 	-39.7358 	21.1530 	-1.1374 	18.9658 	-115.3850 	-3.9080 	-117.5139 	25.8949 	35.4420 	-27.0640 	-11.9997 	0.6706 	-14.2945 	-13.2218 	3.3689 	58.4842 	-14.0148 	-72.5112 	-15.4856 	-34.4250 	-17.7808 	-13.9372 	-3.5448 	-82.6037 	36.1865 	8.9282 	16.4053 	-37.2442 	-2.6314 	131.9872 	-5.2252 	9.1707 	10.3599 	6.5038 	91.6595 	-16.0052 	14.2458 	18.5564 	14.1234 	-3.7396 	-4.8596 	15.7804 	8.1859 	1.3804 	17.1496 	18.1732 	-24.3904 	-11.6381 	-0.1603 	-60.0869 	6.7499 	-6.3898 	-0.6954 	40.1826 	-3.1269];
        w2 = [0.1113 	5.1679 	-7.8650 	-10.1720 	1.3245 	-10.9985 	4.8967 	-11.0366 	8.7357 	1.8278 	2.4905 	-5.5503 	-45.3104 	-7.2796 	-2.3538 	10.0744 	-21.5020 	-2.1765 	-3.4972 	-10.7728 	-0.4669 	10.1060 	0.3016 	3.5550 	6.5450 	4.6314 	-0.8211 	-6.7168 	-0.4529 	-0.1282 	2.1848 	5.7716 	-4.6264 	-7.3398 	0.3753 	-4.3744 	-0.3429 	-3.6403 	0.6425 	13.0653 	0.4626 	7.0679 	-0.8592 	-7.1326 	0.6320 	-0.1074 	-1.2986 	-6.1373 	5.8735 	15.0292 	1.0287 	1.2888 	-0.9478 	1.4711 	5.5655 	-5.3962 	-12.8798 	1.3560 	-9.0526 	-1.5959 	-2.1078 	1.0079 	-0.3332 	-0.9546 	-12.9541 	-0.2396 	-9.6744 	7.8089 	-0.2034 	0.6494 	-10.9937 	8.1972 	0.1289 	0.4327];
        w3 = [0.1929 	-1.6250 	2.9583 	13.4009 	-0.1930 	3.3091 	-1.3006 	7.2670 	-3.3282 	-0.9438 	0.3095 	7.7395 	-3.8977 	2.0270 	-0.8205 	-13.3191 	-1.1899 	-0.2564 	0.9894 	3.3482 	0.9610 	-5.3951 	-1.8969 	-6.2989 	-6.3608 	-7.0371 	1.0365 	3.3361 	-1.1517 	0.2229 	0.2481 	-2.1530 	-0.0635 	6.0319 	-1.0466 	0.3419 	0.8696 	0.8015 	0.3458 	-8.5422 	0.6116 	-6.1249 	0.0177 	3.5436 	0.6480 	-0.1817 	-1.5526 	1.5730 	0.6741 	1.6053 	1.0088 	0.9256 	2.5208 	-0.5418 	0.0607 	2.1606 	9.0178 	0.6832 	1.9705 	1.6001 	-0.1783 	-0.2455 	-2.0846 	-1.0724 	8.7897 	-0.1990 	7.3501 	-0.6167 	-0.3346 	-0.0265 	7.4298 	-0.6749 	-0.6622 	-0.7330];
        v = [0.2142 	0.1758 	-0.2194 	0.2389 	0.2828 	0.0542 	-0.5421 	-0.0047 	-0.2016 	0.2294 	0.2249 	-0.2481 	0.0056 	-0.0265 	0.0647 	0.2402 	-1.4050 	0.1081 	-1.2179 	-0.0325 	-0.8811 	-0.0041 	0.1177 	0.1916 	0.0238 	-0.4240 	0.5638 	-0.1530 	-0.2801 	-0.1418 	2.8230 	0.2197 	0.3115 	-0.0263 	0.2040 	-0.9305 	0.1805 	2.1186 	-0.0673 	-0.2139 	-0.8196 	-0.0517 	0.0398 	0.1437 	0.1177 	0.3677 	0.0723 	-0.2971 	0.0032 	0.0002 	0.1402 	-0.0408 	-0.1898 	-0.0126 	0.0308 	0.2350 	0.2459 	-0.0080 	-0.0341 	0.4387 	-0.5209 	-1.4667 	-0.0687 	-0.4410 	-0.4545 	0.1077 	-0.0057 	-0.8639 	0.0131 	2.0034 	0.0045 	0.6520 	0.0421 	0.4597  ;
            21.5144 	3.5614 	11.4420 	6.7457 	8.4630 	-0.8425 	12.2305 	-4.3212 	9.5610 	13.3568 	-25.5300 	23.6707 	-0.1487 	-0.5595 	-0.7357 	6.8876 	-16.2587 	-28.1657 	-27.3923 	-0.5040 	-51.8478 	0.2604 	7.8488 	-20.3104 	-3.3361 	42.9251 	37.8709 	-8.8700 	-48.2963 	51.6717 	-29.7436 	-8.0381 	9.7112 	9.1028 	-29.3189 	-24.4229 	-27.3119 	48.0935 	2.8576 	-6.1237 	-28.4755 	12.1953 	-6.2974 	7.8200 	44.9418 	-23.0889 	11.8297 	6.9691 	-0.4984 	0.1482 	-14.2896 	-23.0500 	1.1170 	-0.4480 	-0.5361 	-8.8645 	6.4660 	19.8567 	0.6441 	-6.7503 	-0.5550 	9.4654 	1.6674 	-6.1230 	-12.5642 	1.3116 	0.0411 	11.9263 	0.4286 	-21.4982 	4.1072 	-9.0363 	0.1006 	-14.3869];
        b = [-19.3242 	-23.2229 	17.0391 	-38.1886 	29.7586 	18.1802 	-2.6799 	11.3571 	-17.9907 	27.3162 	5.7362 	-84.9927 	-4.5748 	91.9109 	43.1698 	37.9626 	-21.4112 	-10.7359 	14.8506 	34.7287 	-16.9611 	-2.2419 	-11.5697 	78.5777 	0.8604 	79.7998 	-21.5235 	-21.6438 	21.2222 	7.9086 	-4.9081 	6.8647 	12.2648 	-0.1424 	-34.5729 	12.6475 	42.5317 	13.3790 	15.0687 	6.2203 	5.1751 	0.3778 	54.0050 	-22.1084 	-4.8299 	-6.0562 	29.4623 	3.4289 	-85.5599 	-0.6101 	-4.9230 	-7.3338 	-7.3617 	-43.9004 	8.9359 	-6.9467 	-6.8185 	-9.4687 	2.9639 	-2.0056 	-3.3326 	-1.4639 	-0.5681 	-5.8316 	-6.5327 	4.3484 	4.9034 	-8.4035 	15.2798 	-0.8951 	11.2432 	-8.6018 	-5.1373 	-0.0896];
        b0 = [0.3377;    7.7840];
    case 'SA-DSI'
        w1 = [-35.3872 	50.7721 	106.5080 	24.5058 	109.1004 	53.4655 	-59.5485 	-5.7936 	16.7729 	-29.2564 	10.8707 	32.8293 	2.1081 	-37.8805 	-60.9980 	14.2927 	-30.6409 	5.1805 	-105.8443 	82.0676 	61.4581 	-21.7055 	-68.0669 	40.1777 	24.4578 	-49.6165 	-19.8477 	-21.7925 	-41.1411 	2.7843 	41.0630 	19.2755 	19.1609 	-0.4300 	-15.3169 	54.2584 	-1.5304 	-9.0183 	24.3449 	-28.7135 	1.8424 	-18.2942 	-16.9582 	-14.9435 	3.4597 	2.8434 	4.6326 	26.1250 	-17.2866 	-7.5405 	-6.0993 	-0.8963 	44.0204 	-16.0553 	13.7998 	46.9229 	1.3062 	-2.3005 	-3.5720 	2.6071 	9.4084 	2.9391 	-19.0971 	-2.8363 	-22.9545 	13.1690 	4.7349 	27.4149 	-17.2492 	-0.1000 	2.7125 	19.1710 	-23.8909 	27.8776];
        w2 = [-1.6126 	4.6477 	14.1250 	0.4052 	14.1388 	-0.1782 	-5.5897 	-5.1393 	0.3224 	3.4616 	4.1926 	-5.7845 	-6.8203 	21.0225 	3.1268 	9.9793 	5.1315 	-3.5332 	-14.3593 	-0.3269 	0.1621 	-14.8764 	2.5818 	-6.7289 	0.1214 	-3.3010 	-4.3963 	-14.9713 	6.7862 	7.7775 	-0.2403 	-7.4648 	-7.1811 	0.7425 	-2.1255 	3.3022 	6.9498 	-0.7134 	0.3486 	17.7599 	5.0231 	-0.2554 	0.0078 	2.0017 	0.4127 	6.6308 	7.9950 	-1.1453 	13.5131 	2.0920 	-0.3230 	-10.4564 	-0.2507 	1.3259 	9.7994 	-0.2975 	1.4405 	-1.0230 	6.8156 	6.0277 	0.4389 	-6.7700 	-4.6995 	5.3654 	0.9757 	-0.1877 	5.9621 	0.5313 	-0.5164 	-5.4114 	8.2483 	0.9548 	-4.9061 	5.0067];
        w3 = [-2.1240 	-2.4478 	-13.4274 	2.2281 	-14.0816 	-0.8706 	2.7668 	3.4430 	-2.2924 	-6.5677 	-2.1617 	1.6732 	5.3932 	-35.1508 	-4.9800 	-10.3074 	-1.7043 	1.5393 	13.0287 	0.3516 	0.2098 	9.3211 	-0.8483 	6.4164 	1.1760 	4.6143 	0.7441 	9.2417 	-6.5780 	0.0069 	0.3353 	6.4887 	6.4556 	-3.3783 	0.4832 	-5.1739 	-5.0661 	0.3675 	1.0011 	-10.5454 	0.9999 	1.6968 	2.0646 	0.0605 	-3.4049 	1.8906 	6.3700 	0.9097 	-6.8336 	0.9121 	-0.9461 	4.9628 	-0.4969 	-0.6061 	-10.3511 	-0.5212 	0.8739 	1.3951 	-6.3348 	1.9165 	0.5476 	5.9133 	1.9086 	-1.9282 	-0.3443 	1.6825 	-4.7378 	-1.0865 	3.2013 	2.8014 	-0.4188 	0.7068 	2.0414 	-1.7870];
        v = [-0.0184 	-0.7770 	0.3729 	0.5121 	-0.1456 	0.3769 	-0.5361 	1.4139 	-3.7566 	0.0075 	1.4658 	0.0434 	0.2062 	-0.0020 	0.0180 	-0.0039 	0.0803 	0.0987 	0.2431 	-0.0752 	0.0227 	0.0187 	-0.0250 	-0.3518 	0.2549 	0.6370 	-0.0701 	-0.0197 	-0.3267 	0.0351 	0.2067 	0.0365 	-0.0290 	-0.0971 	0.6711 	0.5238 	0.1694 	-2.4173 	-0.3912 	0.0000 	-0.0130 	0.4452 	-0.3290 	0.3990 	-0.0275 	-0.0105 	-0.0119 	0.0427 	-0.0070 	-0.1286 	0.0008 	-0.0111 	0.9669 	-0.1236 	0.0007 	-0.8115 	0.8870 	0.8348 	0.0603 	-0.0171 	0.2754 	0.0120 	0.9022 	-0.2409 	0.0575 	-1.7936 	0.6422 	0.0655 	-2.1403 	-0.2035 	-0.0398 	-0.1383 	0.6281 	0.5232  ;
            3.1170 	18.8733 	41.6802 	11.8217 	-19.7677 	12.2922 	14.3448 	-22.5650 	-28.0668 	0.4707 	-39.4982 	9.4965 	-36.3155 	0.0242 	1.2143 	-1.9830 	11.3812 	-1.2963 	21.5096 	-17.1208 	4.1648 	5.8364 	-1.0018 	-13.0576 	-15.9608 	-8.2831 	1.6078 	-5.6273 	-12.2344 	-5.9201 	36.2437 	-11.4026 	11.6680 	0.1062 	-17.5983 	-6.9483 	-16.7120 	58.8735 	18.5355 	0.1089 	-0.9046 	-10.3737 	6.6671 	-0.2813 	-0.1524 	-0.7948 	-0.1160 	-0.9772 	0.1189 	-0.6520 	15.9918 	0.2709 	-8.0776 	-0.2371 	2.0243 	6.9450 	18.8393 	-8.3581 	12.5328 	-3.1017 	17.1129 	32.4012 	-23.7404 	2.1861 	-0.9014 	-22.9912 	-7.4035 	-0.2966 	-12.8586 	3.1135 	4.7304 	0.3735 	-18.8418 	-15.9679];
        b = [36.8033 	-47.3618 	-92.5855 	-25.8099 	-94.5972 	-52.9188 	55.6644 	9.7987 	-16.9144 	22.9787 	-13.2921 	-29.9607 	-0.5386 	47.1027 	53.7482 	-14.3887 	28.1053 	-1.6179 	92.2408 	-71.0329 	-44.8185 	24.7136 	41.4804 	-33.8398 	-16.6383 	39.2724 	16.4715 	24.8380 	34.6542 	-9.0858 	-35.6476 	-15.5584 	-15.5154 	2.5956 	12.5884 	-42.7203 	0.1344 	7.5777 	-16.4971 	18.4762 	-3.4463 	11.9352 	10.9466 	3.3529 	0.1882 	-7.1525 	-13.9597 	-15.5048 	8.5236 	3.6241 	4.3182 	-0.6123 	-16.9355 	2.5098 	-14.0654 	-18.0294 	-3.9245 	-2.6814 	1.4781 	-10.4812 	-5.6610 	-1.0859 	20.5234 	4.1637 	8.2438 	-14.2253 	-9.4701 	-7.8880 	17.2271 	-2.9451 	-9.2466 	-5.0856 	26.3389 	-29.4222];
        b0 = [0.9208;   -6.7274];
end

%% Model Prediction
n = length(w1);
rho50 = b0(1);
LNsigma_z = b0(2);
for i = 1:n
    rho50 = rho50+v(1,i)./( 1+exp(-b(i)-w1(i)*(log(x_T)+4.6052)/6.9078-...
        w2(i)*(log(100*x_Damp1)+0.6931)/4.0943-...
        w3(i)*(log(100*x_Damp2)+0.6931)/4.0943) );
    LNsigma_z = LNsigma_z+v(2,i)./( 1+exp(-b(i)-w1(i)*(log(x_T)+4.6052)/6.9078-...
        w2(i)*(log(100*x_Damp1)+0.6931)/4.0943-...
        w3(i)*(log(100*x_Damp2)+0.6931)/4.0943) );
end
sigma_z = exp(LNsigma_z);
